# -*- ispell-local-dictionary: "american" -*-
#+TITLE: Making one's work reproducible
#+AUTHOR: @@latex:{\large Christophe Pouzat} \\ \vspace{0.2cm}MAP5, Paris-Descartes University and CNRS\\ \vspace{0.2cm} \texttt{christophe.pouzat@parisdescartes.fr}@@
#+DATE: LASCON, January 19 2018, Lecture 1
#+OPTIONS: H:2 tags:nil
#+EXCLUDE_TAGS: noexport
#+LANGUAGE: en
#+SELECT_TAGS: export
#+LATEX_CLASS: beamer
#+LATEX_CLASS_OPTIONS: [presentation,bigger]
#+BEAMER_HEADER: \setbeamercovered{invisible}
#+BEAMER_HEADER: \AtBeginSection[]{\begin{frame}<beamer>\frametitle{Where are we ?}\tableofcontents[currentsection]\end{frame}}
#+BEAMER_HEADER: \beamertemplatenavigationsymbolsempty
#+STARTUP: beamer
#+COLUMNS: %45ITEM %10BEAMER_ENV(Env) %10BEAMER_ACT(Act) %4BEAMER_COL(Col) %8BEAMER_OPT(Opt)
#+STARTUP: indent
#+PROPERTY: header-args :eval no-export

* Introduction

** The usual presentation of research work
#+BEGIN_QUOTE
  An article about computational science in a scientific publication is
  *not* the scholarship itself, it is merely *advertising* of the
  scholarship. The actual scholarship is the complete software
  development environment and the complete set of instructions which
  generated the figures.
#+END_QUOTE

\vspace{0.2cm}
Thoughts of Jon Claerbout "distilled" by Buckheit & Donoho (1995).

** What do we do as manuscript "producers"?
The preparation of manuscripts and reports in experimental or computational neuroscience often
involves:
- Doing the experiments or coding and doing the simulations.
- A lot of data analysis.
- Careful design and realization of figures and tables.

Simulations involve:
- Algorithmic choices.
- Software choices or implementation.
- Parameters setting (/e.g./, the time step used for conductance based neuronal models).
 
Data analysis involves:
- Some data "preprocessing" (often).
- The development of dedicated scripts, routines and codes.
- Setting some critical parameters.

** What would we like as manuscript "readers"?
As readers or referees of articles / manuscripts we are therefore often led to ask questions like:
- What would happen to the analysis (or simulation) results if a given
  parameter had another value?
- What would be the effect of applying my preprocessing to the data
  instead of the one used by the authors?
- What would a given figure look like with a log scale ordinate instead
  of the linear scale use by the authors?
- What would be the result of applying that same analysis to my own data
  set ?
We can of course all think of a dozen of similar questions.

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
The problem is to find a way to address them. Clearly the classical
journal article format cannot do the job. Editors cannot publish two
versions of each figure to satisfy different readers. Many intricate
analysis and modeling methods would require too long a description to
fit the usual bounds of the printed paper. This is reasonable for we
all have a lot of different things to do and we cannot afford to
systematically look at every piece of work as thoroughly as suggested
above. Many people (Claerbout & Karrenbach, 1992; Buckheit and Donoho,
1995; Rossini & Leisch, 2003; Baggerly, 2010; Diggle & Zeger, 2010;
Stein, 2011) feel nevertheless uncomfortable with the present way of
diffusing scientific information as a canonical (printed) journal
article. We suggest what is needed are more systematic and more
explicit ways to describe how the analysis (or modeling) was done.

** The dilemma
Clearly the classical journal article format cannot do the job. 
- Editors cannot publish two versions of each figure to satisfy different readers.
- Many intricate analysis and modeling methods would require too long a description to fit the usual bounds of the printed paper.
- We all have, moreover, a lot of different things to do and we cannot afford to systematically look at every piece of work as thoroughly as suggested above.
\vspace{0.1cm}
*We need are more systematic and more explicit ways to describe how the analysis (or modeling) was done*.

** The solution $\rightarrow$ Reproducible Research

*Reproducible Research* (=RR=) or *reproducible data analysis* is an approach aiming at complementing classical printed scientific articles with *everything* required to independently reproduce the results they present.

\vspace{0.25cm}
"Everything" covers here: 
- the data, 
- the computer codes,
- a precise description of how the code was applied to the data. 

\vspace{0.25cm}
The "movement" started with what Economists have been calling *replication* since the early eighties to reach what is now called *reproducible research* in computational data analysis oriented fields like statistics and signal processing.

* What is needed for Reproducible Research?
* Note taking concerns everyone
** The scholar annotating his book / manuscript

[[./imgs/ManuscritAnnoteEtCoupe.png]]

\vspace{0.25cm}
A XIVth  century manuscript with the works of Aristotle owned by Nicasius de Planca (gallica.bnf.fr / Bibliothèque nationale de France).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
We see a manuscript from the XIVth century heavily annotated by its owner Nicasius de Planca. This kind of notes taking was and remains extremely common. You should nevertheless avoid it when reading books from a library or from your friends!

The next two slides show a case of paramount importance for the History of Science.
 
** Galileo observing Jupiter's moons

[[./imgs/GalileoManuscriptCoupe.png]]

\vspace{0.25cm}
Galileo Galilei's notes while observing Jupiter in January 1610 with his telescope (Wikimedia Commons).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
The first observation was done on January 7 1610. Galileo Galilei first thought that he found new stars close to Jupiter (see the [[https://en.wikipedia.org/wiki/Galileo_Galilei#Jupiter's_moons][Wikipedia page]]). But after several nights of observation, he realized that these "stars" were in fact circling around the planet, *they are satellites*! He named the group of four the Medicean stars, in honour of his future patron, Cosimo II de' Medici, Grand Duke of Tuscany, and Cosimo's three brothers (Wikipedia).

** 
[[./imgs/GalileoManuscriptZoom.png]]

\vspace{0.25cm}
The small "stars" are in fact orbiting around Jupiter, *they are doing what the Moon does around the Earth* (Wikimedia Commons).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
These observations lead Galileo to reject the geocentric hypothesis in favor of the heliocentric one. This brought him much later, and after a somewhat tortuous path that I don't have the space to describe now, in front of the Inquisition that sentences him on June 22 1633 to house arrest, which he remained under for the rest of his life. 

** Placcius and Leibniz cabinet

[[./imgs/Placcius_cabinet_TabIV.png]]

\vspace{0.25cm}
Organizing notes Placcius' way (Placcius, Vincent, 1642-1699. /De arte excerpendi vom gelahrten Buchhalten/, 1689. Houghton Library, Harvard University.)

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
With printing appearance, demand for paper increased and paper's price ended up decreasing (after a large production increase). In addition to the use of the /codex/ with pages made of paper, many scholars started using paper slips.

But taking abundant notes on paper slips is good only if one can find efficiently retrieve this stored information when needed. Vincent Placcius (1642-1699) and Gottfried Leibniz (1646-1716) had a custom made cabinet to solve this retrieval problem.

**  
*** 
:PROPERTIES:
:BEAMER_COL: 0.48
:BEAMER_ENV: block
         :END:

#+ATTR_LATEX: :width 0.6\textwidth
[[./imgs/Placcius_cabinet_TabIVzoom.png]]

*** 
:PROPERTIES:
:BEAMER_COL: 0.48
:BEAMER_ENV: block
         :END:

Zoom on the columns of Paccius' cabinet. You can see the "front" (left column), the "side" (second from left) and the "back" (fourth from left).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
This cabinet had many columns that could rotate about their (vertical) axis. The column's front was used to write what we would now call keywords relating to the content of the notes that were hooked on the column's back side.

Notice the advantage of these paper slips over Galileo's codex: with the former, notes can be reorganized.
  
** Beware of overabundance: Fulgence Tapir's disappearance
*** 
:PROPERTIES:
:BEAMER_COL: 0.48
:BEAMER_ENV: block
         :END:

#+BEGIN_SRC shell :exports none :results hide
cd imgs && wget https://upload.wikimedia.org/wikipedia/commons/c/c1/Anatole_France_young_years.jpg
#+END_SRC

#+RESULTS:

#+ATTR_LATEX: :width 0.9\textwidth
[[./imgs/Anatole_France_young_years.jpg]]

*** 
:PROPERTIES:
:BEAMER_COL: 0.48
:BEAMER_ENV: block
         :END:

In 1908, [[https://en.wikipedia.org/wiki/Anatole_France][Anatole France]] (1844-1924) published "[[https://archive.org/stream/in.ernet.dli.2015.220207/2015.220207.Penguin-Island_djvu.txt][Penguin Island]]" a parody of French history. 

By Photographer : Wilhelm Benque. Tucker Collection - New York Public Library Archives, Public Domain, https://commons.wikimedia.org/w/index.php?curid=16240632.  

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
The text can be found /legally/ at several places, the [[https://en.wikipedia.org/wiki/Project_Gutenberg][Project Gutenberg]] one is missing the "Preface", so don't use it, go to one of the versions available on [[https://archive.org/search.php?query=title%3Apenguin%20island%20AND%20-contributor%3Agutenberg%20AND%20mediatype%3Atexts][Internet Archive]]. The importance of the preface in illustrated by the following two quotations:

#+BEGIN_QUOTE
One word more if you want your book to be well 
received, lose no opportunity for exalting the virtues on 
which society is based — attachment to wealth, pious senti- 
ments, and especially resignation on the part of the poor, 
which latter is the very foundation of order. Proclaim, sir, 
that the origins of property — nobility and police — are treat- 
ed in your history with the respect which these institutions 
deserve. Make it known that you admit the supernatural 
when it presents itself. On these conditions you will succeed 
in good society.
#+END_QUOTE

And more importantly for our present subject:

#+BEGIN_QUOTE
The idea occurred to me, in the month of June last year, to 
go and consult on the origins and progress of Penguin art, 
the lamented M. Fulgence Tapir, the learned author of the 
‘Universal Annals of Painting, Sculpture and Architecture’ 

Having been shown into his study, I found seated before a 
roll-top desk, beneath a frightful mass of papers, an amaz- 
ingly short-sighted little man whose eyelids blinked behind 
his gold-mounted spectacles. 

To make up for the defect of his eyes his long and mobile 
nose, endowed with an exquisite sense of touch, explored the 
sensible world. By means of this organ Fulgence Tapir put 
himself in contact with art and beauty. It is observed that in 
France, as a general rule, musical critics are deaf and art 
critics are blind. This allows them the collectedness neces- 
sary for æsthetic ideas. Do you imagine that with eyes capable 
of perceiving the forms and colours with which mysterious 
nature envelops herself, Fulgence Tapir would have raised 
himself, on a mountain of printed and manuscript docu- 
ments, to the summit of doctrinal spiritualism, or that he
would have conceived that mighty theory which makes the 
arts of all tunes and countries converge towards the Institute 
of France, their supreme end? 

The walls of the study, the floor, and even the ceiling were 
loaded with overflowing bundles, pasteboard boxes swollen 
beyond measure, boxes in which were compressed an in- 
numerable multitude of small cards covered with writing. I 
beheld in admiration minted with terror the cataracts of 
erudition that threatened to burst forth. 

‘Master,’ said I in feeling tones, ‘I throw myself upon 
your kindness and your knowledge, both of which are 
inexhaustible. Would you consent to guide me in my 
arduous researches into the origins of Penguin art?’ 

‘Sir,’ answered the Master, ‘I possess all art, you under- 
stand me, all art, on cards classed alphabetically and in 
order of subjects. I consider it my duty to place at your dis- 
posal all that relates to the Penguins. Get on that ladder and 
take out that box you see above. You will find in it every- 
thing you require.’ 

I tremblingly obeyed. But scarcely had I opened the fatal 
box than some blue cards escaped from it, and slipping 
through my fingers, began to rain down. Almost immediate- 
ly, acting in sympathy, the neighbouring boxes opened, and 
there flowed streams of pink, green, and white cards, and by 
degrees, from all the boxes, differently coloured cards were 
poured out murmuring like a waterfall on a mountain side 
in April. In a minute they covered the floor with a thick 
layer of paper. Issuing from their inexhaustible reservoirs 
with a roar that continually grew in force, each second in- 
creased the vehemence of their torrential fall. Swamped up 
to the knees in cards, Fulgence Tapir observed the cataclysm 
with attentive nose. He recognised its cause and grew pale 
with fright 

‘What a mass of art !’ he exclaimed. 

I called to him and leaned forward to help him mount the 
ladder which bent under the shower. It was too late. Over- 
whelmed, desperate, pitiable, his velvet smoking-cap and his 
gold-mounted spectacles having fallen from him, he vainly 
opposed his short arms to the flood which had now mounted 
to his arm-pits. Suddenly a terrible spurt of cards arose and 
enveloped him in a gigantic whirlpool. During the space of a 
second I could see in the gulf the shining skull and little fat 
hands of the scholar, then it closed up and the deluge kept 
on pouring over what was silence and immobility. In dread 
lest I in my turn should be swallowed up ladder and all I 
maae my escape through the topmost pane of the window.  
#+END_QUOTE

** A sailor's notebook
** What should we use to take notes?
** Avoid getting lost
* Note taking: a quick History
* Form text files to lightweight markup languages
* Notes that are archived but can evolve with control version systems (CVS)
* Finding your way in your notes: tags and indexing software
