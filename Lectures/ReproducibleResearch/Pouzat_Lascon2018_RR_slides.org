# -*- ispell-local-dictionary: "american" -*-
#+TITLE: Making one's work reproducible
#+AUTHOR: @@latex:{\large Christophe Pouzat} \\ \vspace{0.2cm}MAP5, Paris-Descartes University and CNRS\\ \vspace{0.2cm} \texttt{christophe.pouzat@parisdescartes.fr}@@
#+DATE: LASCON, January 19 2018, Lecture 1
#+OPTIONS: H:2 tags:nil
#+EXCLUDE_TAGS: noexport
#+LANGUAGE: en
#+SELECT_TAGS: export
#+LATEX_CLASS: beamer
#+LATEX_CLASS_OPTIONS: [presentation,bigger]
#+BEAMER_HEADER: \setbeamercovered{invisible}
#+BEAMER_HEADER: \AtBeginSection[]{\begin{frame}<beamer>\frametitle{Where are we ?}\tableofcontents[currentsection]\end{frame}}
#+BEAMER_HEADER: \beamertemplatenavigationsymbolsempty
#+STARTUP: beamer
#+COLUMNS: %45ITEM %10BEAMER_ENV(Env) %10BEAMER_ACT(Act) %4BEAMER_COL(Col) %8BEAMER_OPT(Opt)
#+STARTUP: indent
#+PROPERTY: header-args :eval no-export

* Introduction

** The usual presentation of research work
#+BEGIN_QUOTE
  An article about computational science in a scientific publication is
  *not* the scholarship itself, it is merely *advertising* of the
  scholarship. The actual scholarship is the complete software
  development environment and the complete set of instructions which
  generated the figures.
#+END_QUOTE

\vspace{0.2cm}
Thoughts of Jon Claerbout "distilled" by Buckheit & Donoho (1995).

** What do we do as manuscript "producers"?
The preparation of manuscripts and reports in experimental or computational neuroscience often
involves:
- Doing the experiments or coding and doing the simulations.
- A lot of data analysis.
- Careful design and realization of figures and tables.

Simulations involve:
- Algorithmic choices.
- Software choices or implementation.
- Parameters setting (/e.g./, the time step used for conductance based neuronal models).
 
Data analysis involves:
- Some data "preprocessing" (often).
- The development of dedicated scripts, routines and codes.
- Setting some critical parameters.

** What would we like as manuscript "readers"?
As readers or referees of articles / manuscripts we are therefore often led to ask questions like:
- What would happen to the analysis (or simulation) results if a given
  parameter had another value?
- What would be the effect of applying my preprocessing to the data
  instead of the one used by the authors?
- What would a given figure look like with a log scale ordinate instead
  of the linear scale use by the authors?
- What would be the result of applying that same analysis to my own data
  set ?
We can of course all think of a dozen of similar questions.

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
The problem is to find a way to address them. Clearly the classical
journal article format cannot do the job. Editors cannot publish two
versions of each figure to satisfy different readers. Many intricate
analysis and modeling methods would require too long a description to
fit the usual bounds of the printed paper. This is reasonable for we
all have a lot of different things to do and we cannot afford to
systematically look at every piece of work as thoroughly as suggested
above. Many people (Claerbout & Karrenbach, 1992; Buckheit and Donoho,
1995; Rossini & Leisch, 2003; Baggerly, 2010; Diggle & Zeger, 2010;
Stein, 2011) feel nevertheless uncomfortable with the present way of
diffusing scientific information as a canonical (printed) journal
article. We suggest what is needed are more systematic and more
explicit ways to describe how the analysis (or modeling) was done.

** The dilemma
Clearly the classical journal article format cannot do the job. 
- Editors cannot publish two versions of each figure to satisfy different readers.
- Many intricate analysis and modeling methods would require too long a description to fit the usual bounds of the printed paper.
- We all have, moreover, a lot of different things to do and we cannot afford to systematically look at every piece of work as thoroughly as suggested above.
\vspace{0.1cm}
*We need are more systematic and more explicit ways to describe how the analysis (or modeling) was done*.

** The solution $\rightarrow$ Reproducible Research

*Reproducible Research* (=RR=) or *reproducible data analysis* is an approach aiming at complementing classical printed scientific articles with *everything* required to independently reproduce the results they present.

\vspace{0.25cm}
"Everything" covers here: 
- the data, 
- the computer codes,
- a precise description of how the code was applied to the data. 

\vspace{0.25cm}
The "movement" started with what Economists have been calling *replication* since the early eighties to reach what is now called *reproducible research* in computational data analysis oriented fields like statistics and signal processing.

* What is needed for Reproducible Research?
* Note-taking concerns everyone
** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
The purpose of this section is remind the reader / auditor that *note-taking concerns everyone*. Few examples are used to that end. 

** The scholar annotating his book / manuscript

[[./imgs/ManuscritAnnoteEtCoupe.png]]

\vspace{0.25cm}
A XIVth  century manuscript with the works of Aristotle owned by Nicasius de Planca (gallica.bnf.fr / Bibliothèque nationale de France).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
We see a manuscript from the XIVth century heavily annotated by its owner Nicasius de Planca. This kind of note-taking was and remains extremely common. You should nevertheless avoid it when reading books from a library or from your friends!

The next two slides show a case of paramount importance for the History of Science.
 
** Galileo observing Jupiter's moons

[[./imgs/GalileoManuscriptCoupe.png]]

\vspace{0.25cm}
Galileo Galilei's notes while observing Jupiter in January 1610 with his telescope (Wikimedia Commons).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
The first observation was done on January 7 1610. Galileo Galilei first thought that he found new stars close to Jupiter (see the [[https://en.wikipedia.org/wiki/Galileo_Galilei#Jupiter's_moons][Wikipedia page]]). But after several nights of observation, he realized that these "stars" were in fact circling around the planet, *they are satellites*! He named the group of four the Medicean stars, in honour of his future patron, Cosimo II de' Medici, Grand Duke of Tuscany, and Cosimo's three brothers (Wikipedia).

** 
[[./imgs/GalileoManuscriptZoom.png]]

\vspace{0.25cm}
The small "stars" are in fact orbiting around Jupiter, *they are doing what the Moon does around the Earth* (Wikimedia Commons).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
These observations lead Galileo to reject the geocentric hypothesis in favor of the heliocentric one. This brought him much later, and after a somewhat tortuous path that I don't have the space to describe now, in front of the Inquisition that sentences him on June 22 1633 to house arrest, which he remained under for the rest of his life. 

** Placcius and Leibniz cabinet

[[./imgs/Placcius_cabinet_TabIV.png]]

\vspace{0.25cm}
Organizing notes Placcius' way (Placcius, Vincent, 1642-1699. /De arte excerpendi vom gelahrten Buchhalten/, 1689. Houghton Library, Harvard University.)

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
With printing appearance, demand for paper increased and paper's price ended up decreasing (after a large production increase). In addition to the use of the /codex/ with pages made of paper, many scholars started using paper slips.

But taking abundant notes on paper slips is good only if one can find efficiently retrieve this stored information when needed. Vincent Placcius (1642-1699) and Gottfried Leibniz (1646-1716) had a custom made cabinet to solve this retrieval problem.

**  
*** 
:PROPERTIES:
:BEAMER_COL: 0.48
:BEAMER_ENV: block
         :END:

#+ATTR_LATEX: :width 0.6\textwidth
[[./imgs/Placcius_cabinet_TabIVzoom.png]]

*** 
:PROPERTIES:
:BEAMER_COL: 0.48
:BEAMER_ENV: block
         :END:

Zoom on the columns of Paccius' cabinet. You can see the "front" (left column), the "side" (second from left) and the "back" (fourth from left).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
This cabinet had many columns that could rotate about their (vertical) axis. The column's front was used to write what we would now call keywords relating to the content of the notes that were hooked on the column's back side.

Notice the advantage of these paper slips over Galileo's codex: with the former, notes can be reorganized.
  
** Beware of overabundance: Fulgence Tapir's disappearance
*** 
:PROPERTIES:
:BEAMER_COL: 0.48
:BEAMER_ENV: block
         :END:

#+BEGIN_SRC shell :exports none :results hide
cd imgs && wget https://upload.wikimedia.org/wikipedia/commons/c/c1/Anatole_France_young_years.jpg
#+END_SRC

#+RESULTS:

#+ATTR_LATEX: :width 0.9\textwidth
[[./imgs/Anatole_France_young_years.jpg]]

*** 
:PROPERTIES:
:BEAMER_COL: 0.48
:BEAMER_ENV: block
         :END:

In 1908, [[https://en.wikipedia.org/wiki/Anatole_France][Anatole France]] (1844-1924) published "[[https://archive.org/stream/in.ernet.dli.2015.220207/2015.220207.Penguin-Island_djvu.txt][Penguin Island]]" a parody of French history. 

By Photographer : Wilhelm Benque. Tucker Collection - New York Public Library Archives, Public Domain, https://commons.wikimedia.org/w/index.php?curid=16240632.  

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
The text can be found /legally/ at several places, the [[https://en.wikipedia.org/wiki/Project_Gutenberg][Project Gutenberg]] one is missing the "Preface", so don't use it, go to one of the versions available on [[https://archive.org/search.php?query=title%3Apenguin%20island%20AND%20-contributor%3Agutenberg%20AND%20mediatype%3Atexts][Internet Archive]]. The importance of the preface in illustrated by the following two quotations:

#+BEGIN_QUOTE
One word more if you want your book to be well 
received, lose no opportunity for exalting the virtues on 
which society is based — attachment to wealth, pious senti- 
ments, and especially resignation on the part of the poor, 
which latter is the very foundation of order. Proclaim, sir, 
that the origins of property — nobility and police — are treat- 
ed in your history with the respect which these institutions 
deserve. Make it known that you admit the supernatural 
when it presents itself. On these conditions you will succeed 
in good society.
#+END_QUOTE

And more importantly for our present subject:

#+BEGIN_QUOTE
The idea occurred to me, in the month of June last year, to 
go and consult on the origins and progress of Penguin art, 
the lamented M. Fulgence Tapir, the learned author of the 
‘Universal Annals of Painting, Sculpture and Architecture’ 

Having been shown into his study, I found seated before a 
roll-top desk, beneath a frightful mass of papers, an amaz- 
ingly short-sighted little man whose eyelids blinked behind 
his gold-mounted spectacles. 

To make up for the defect of his eyes his long and mobile 
nose, endowed with an exquisite sense of touch, explored the 
sensible world. By means of this organ Fulgence Tapir put 
himself in contact with art and beauty. It is observed that in 
France, as a general rule, musical critics are deaf and art 
critics are blind. This allows them the collectedness neces- 
sary for æsthetic ideas. Do you imagine that with eyes capable 
of perceiving the forms and colours with which mysterious 
nature envelops herself, Fulgence Tapir would have raised 
himself, on a mountain of printed and manuscript docu- 
ments, to the summit of doctrinal spiritualism, or that he
would have conceived that mighty theory which makes the 
arts of all tunes and countries converge towards the Institute 
of France, their supreme end? 

The walls of the study, the floor, and even the ceiling were 
loaded with overflowing bundles, pasteboard boxes swollen 
beyond measure, boxes in which were compressed an in- 
numerable multitude of small cards covered with writing. I 
beheld in admiration minted with terror the cataracts of 
erudition that threatened to burst forth. 

‘Master,’ said I in feeling tones, ‘I throw myself upon 
your kindness and your knowledge, both of which are 
inexhaustible. Would you consent to guide me in my 
arduous researches into the origins of Penguin art?’ 

‘Sir,’ answered the Master, ‘I possess all art, you under- 
stand me, all art, on cards classed alphabetically and in 
order of subjects. I consider it my duty to place at your dis- 
posal all that relates to the Penguins. Get on that ladder and 
take out that box you see above. You will find in it every- 
thing you require.’ 

I tremblingly obeyed. But scarcely had I opened the fatal 
box than some blue cards escaped from it, and slipping 
through my fingers, began to rain down. Almost immediate- 
ly, acting in sympathy, the neighbouring boxes opened, and 
there flowed streams of pink, green, and white cards, and by 
degrees, from all the boxes, differently coloured cards were 
poured out murmuring like a waterfall on a mountain side 
in April. In a minute they covered the floor with a thick 
layer of paper. Issuing from their inexhaustible reservoirs 
with a roar that continually grew in force, each second in- 
creased the vehemence of their torrential fall. Swamped up 
to the knees in cards, Fulgence Tapir observed the cataclysm 
with attentive nose. He recognised its cause and grew pale 
with fright 

‘What a mass of art !’ he exclaimed. 

I called to him and leaned forward to help him mount the 
ladder which bent under the shower. It was too late. Over- 
whelmed, desperate, pitiable, his velvet smoking-cap and his 
gold-mounted spectacles having fallen from him, he vainly 
opposed his short arms to the flood which had now mounted 
to his arm-pits. Suddenly a terrible spurt of cards arose and 
enveloped him in a gigantic whirlpool. During the space of a 
second I could see in the gulf the shining skull and little fat 
hands of the scholar, then it closed up and the deluge kept 
on pouring over what was silence and immobility. In dread 
lest I in my turn should be swallowed up ladder and all I 
maae my escape through the topmost pane of the window.  
#+END_QUOTE

** A sailor's logbook

[[./imgs/LivredebordpenduickV.JPG]]

\vspace{0.25cm}
The logbook of Eric Tabarly during the San-Francisco / Tokyo transpacific ocean race in 1969.

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
This example is only superficially anecdotal. Information about the source can be found at: [[https://commons.wikimedia.org/wiki/File:LivredebordpenduickV.JPG]].

** 
#+ATTR_LATEX: :width 0.9\textwidth
[[./imgs/LivredebordpenduickVzoom1.png]]

\vspace{0.25cm}
On the left side, Tabarly reports salient events like a ripped jib on March 21 at 11 pm. 

** 
#+ATTR_LATEX: :width 0.8\textwidth
[[./imgs/LivredebordpenduickVzoom2.png]]

\vspace{0.25cm}
On the right side, he computes his position (that was before GPS time!).

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
This example is only superficially anecdotal. Ten years ago, a European project was aiming at estimating the Atlantic and Indian Oceans climates during the 18th century using logbooks from ships of the West- and East-India companies from the Kingdoms of Portugal, Spain, Holland, Britain and France. See the [[http://webs.ucm.es/info/cliwoc/][Climatological Database for the World's Oceans 1750-1850]].
   
In the same vein, logbooks from slave ships give a lot of quantitative information about the slave trade between Africa and the "New World".


** So, what should we use to take notes?
- The object of study (like the annotated book)?
- One or several notebooks?
- Paper slips or cards?
- Computer files?
- Drawings, Pictures?
- Films?
- ...?

** Avoid getting lost
Notes generate an organizational problem:
\vspace{0.25cm}
- How can we structure our notes?
- Can we index them, if yes, how?
- How can we archive them while keeping the capability to make them evolve?

*** Notes 
:PROPERTIES:
:BEAMER_ENV: note
:END:
Notes are necessarily heterogeneous---because of their subject matter as well as, often, their material support---and that creates a *serious* organizational problem.

*Without organization, notes usability barely exceeds our capability of memorizing facts and events*.

In the sequel we are going to give /tentative/ answers to the questions raised in the last two slides. 
* Note-taking: a quick History
** Since note-taking concerns everyone...

- Since we are all "note-takers", our predecessors also were note-takers.
- This elementary observation will lead us to "study" how our brilliant ancestors took notes.
- Hopefully, we can learn some useful techniques on the way and put them on daily use.
- Hopefully, we can avoid thinking that we are the first to face the kind of problem we are now facing: "information overload".

** What are we going to talk about?  

- The practical aspect of note-taking---what Historians dub "materiality---.
- The books and notes organization.
- The link between the concrete and organizational aspects.

*** Clarification
:PROPERTIES:
:BEAMER_ENV: note
:END:
We are going to discuss a lot books organization since the "navigation devices" designed for the latter: 
- table of content,
- index,
- etc,
also applies to notes.

We will mostly refer to the "Western" part of this History, with a single slide on Chinese contributions and nothing on Muslim, Indian or pre-Colombian contributions. This bias must be clearly understood as a *reflection of my ignorance* (I'm actively learning on the subject) and because it's easier, as always, to find illustrative material for "Western" contributions...

** The concrete aspects summarized on a single slide 

#+NAME: Making-concrete-summary-of-material aspect
#+BEGIN_SRC shell :exports none :results hide
# This requires imagemagick
cd imgs & \
    wget https://upload.wikimedia.org/wikipedia/commons/thumb/e/e2/Clay_Tablet_-_Louvre_-_AO29562.jpg/1024px-Clay_Tablet_-_Louvre_-_AO29562.jpg -O Tablette_argile.jpg \
	 wget https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Meister_des_Portr%C3%A4ts_des_Paquius_Proculus_001.jpg/651px-Meister_des_Portr%C3%A4ts_des_Paquius_Proculus_001.jpg -O Proculus.jpg \
	 wget https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/Commonplace_book_mid_17th_century.jpg/878px-Commonplace_book_mid_17th_century.jpg -O Carnet.jpg \
	 wget https://upload.wikimedia.org/wikipedia/commons/6/6e/Lhfhospitalsstatehospital001.jpg -O Carte.jpg \
	 wget https://upload.wikimedia.org/wikipedia/commons/e/ef/Fait_cnv.jpg -O Post_it.jpg \
	 wget https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Lenovo_Yoga_3_Pro.jpg/1024px-Lenovo_Yoga_3_Pro.jpg -O Tablette_ordi.jpg \
	 montage -mode concatenate -tile 3x2 Tablette_argile.jpg Proculus.jpg Carnet.jpg Carte.jpg Post_it.jpg Tablette_ordi.jpg Figure_W1_S2_1.jpg
#+END_SRC

#+ATTR_LATEX: :width 1.0\textwidth
[[./imgs/Figure_W1_S2_1.jpg]]

*** Details
:PROPERTIES:
:BEAMER_ENV: note
:END:
All illustrations are taken from Wikimedia Commons
- Top left: A clay tablet (pre-cuneiform period, -3000).
- Top center: A fresco from Pompeii with the portrait of [[https://en.wikipedia.org/wiki/Portrait_of_Paquius_Proculo][Terentius Neo and his wife]]. She carries a [[https://en.wikipedia.org/wiki/Wax_tablet][wax tablet]] and a /stylus/ (the main medium of note-takers up to the 19th century); he carries a /volumen/ or [[https://en.wikipedia.org/wiki/History_of_scrolls][scroll]], the stuff of books until the beginning of the Common Era.
- Top right: a notebook made of paper from the 17th century with [[https://en.wikipedia.org/wiki/Commonplace_book][commonplaces]]. "Commonplace" is a translation of the Latin term locus communis (from Greek tópos koinós, see literary topos) which means "a theme or argument of general application", such as a statement of proverbial wisdom (Wikipedia).
- Bottom left: An [[https://en.wikipedia.org/wiki/Index_card][index card]], a notes medium whose use exploded with bureaucratization and the development of libraries. Still heavily used in the humanities. Apparently first used (if not created) by the father of taxonomy, [[https://en.wikipedia.org/wiki/Carl_Linnaeus][Carl Linneaus]]. You can find his cards at: [[http://linnean-online.org/61332/#/0]].
- Bottom center: A [[https://en.wikipedia.org/wiki/Post-it_note][Post-it note]] as most of us use every day.
- Bottom right: A "modern days" numerical tablet.    

** Wax tablet and stylus

#+ATTR_LATEX: :width 1.0\textwidth
[[./imgs/tabula_stilus.jpg]]

*** Details
:PROPERTIES:
:BEAMER_ENV: note
:END:
From the [[https://en.wikipedia.org/wiki/Wax_tablet][Wikipedia page]]:
 
A wax tablet is a tablet made of wood and covered with a layer of wax, often linked loosely to a cover tablet, as a "double-leaved" diptych. It was used as a reusable and portable writing surface in Antiquity and throughout the Middle Ages.

Writing on the wax surface was performed with a pointed instrument, a stylus. Writing by engraving in wax required the application of much more pressure and traction than would be necessary with ink on parchment or papyrus,[1] and the scribe had to lift the stylus in order to change the direction of the stroke. Therefore, the stylus could not be applied with the same degree of dexterity as a pen. A straight-edged, spatula-like implement (often placed on the opposite end of the stylus tip) would be used in a razor-like fashion to serve as an eraser. The entire tablet could be erased for reuse by warming it to about 50 °C and smoothing the softened wax surface. The modern expression of "a clean slate" equates to the Latin expression "tabula rasa".

** From the /scroll/ to the /codex/ 

#+ATTR_LATEX: :width 1.0\textwidth
[[./imgs/Figure_W1_S2_3.jpg]]

*** Details
:PROPERTIES:
:BEAMER_ENV: note
:END:

The shift from the /scroll/ to the /codex/ is fundamental for development of written civilization.

A scroll (from the Old French escroe or escroue), is a roll of papyrus, parchment, or paper containing writing.

From [[https://en.wikipedia.org/wiki/History_of_scrolls#Replacement_by_the_Codex][Wikipedia]]:

The codex was a new format for reading the written word, consisting of individual pages loosely attached to each other at one side and bound with boards or cloth. It came to replace the scroll thanks to several problems that limited the scroll's function and readability. For one, scrolls were very long, sometimes as long as ten meters. This made them hard to hold open and read, a difficulty not helped by the fact that most scrolls in that era were read horizontally, instead of vertically as scrolling virtual documents are read now. The text on a scroll was continuous, without page breaks, which made indexing and bookmarking impossible. Conversely, the codex was easier to hold open, separate pages made it possible to index sections and mark a page, and the protective covers kept the fragile pages intact better than scrolls generally stayed. This last made it particularly attractive for important religious texts.

As explained by Frédéric Barbier (/Histoire du Livre/): "The scroll / volumen imposes a complex reading practice: one must unroll (/explicare/) and roll at the same time; that forbids working on several scrolls (the original text and its commentary) at the same time or to take notes. It imposes a continuous reading and making consultation impossible."


* Form text files to lightweight markup languages
* Notes that are archived but can evolve with control version systems (CVS)
* Finding your way in your notes: tags and indexing software
