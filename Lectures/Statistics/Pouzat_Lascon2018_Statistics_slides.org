# -*- ispell-local-dictionary: "american" -*-
#+TITLE: A glimpse of the Statistician's toolbox
#+AUTHOR: @@latex:{\large Christophe Pouzat} \\ \vspace{0.2cm}MAP5, Paris-Descartes University and CNRS\\ \vspace{0.2cm} \texttt{christophe.pouzat@parisdescartes.fr}@@
#+DATE: LASCON, January 22 2018, Lecture 2
#+OPTIONS: H:2 tags:nil
#+EXCLUDE_TAGS: noexport
#+LANGUAGE: en
#+SELECT_TAGS: export
#+LATEX_CLASS: beamer
#+LATEX_CLASS_OPTIONS: [presentation]
#+BEAMER_HEADER: \setbeamercovered{invisible}
#+BEAMER_HEADER: \AtBeginSection[]{\begin{frame}<beamer>\frametitle{Where are we ?}\tableofcontents[currentsection]\end{frame}}
#+BEAMER_HEADER: \beamertemplatenavigationsymbolsempty
#+STARTUP: beamer
#+COLUMNS: %45ITEM %10BEAMER_ENV(Env) %10BEAMER_ACT(Act) %4BEAMER_COL(Col) %8BEAMER_OPT(Opt)
#+STARTUP: indent
#+PROPERTY: header-args :eval no-export

* Setup :noexport:
#+NAME: set-gnuplot-pars
#+BEGIN_SRC gnuplot :session *gnuplot* :results silent :eval no-export :exports none 
set terminal pngcairo size 1000,1000
#+END_SRC

* Introduction :export:
** What are we going to talk about? 
- Descriptive statistics that are *robust*: =median=, =median absolute deviation=, =five-number summary=.
- =Cumulative Distribution Functions= (CDF) and their observed or empirical versions (ECDF).
- =Histograms= and the choice of bin width in histograms.
- The =Likelihood= function.
- The =Maximum Likelihood Estimator= (MLE) and its properties.

* Descriptive statistics :export:
** What makes a statistic "robust"?
- Robust statistics are "well behaved" even when something goes wrong.
- We will illustrate what that means with robust versions of the classical /location/ and /scale/ parameters:
  + the *median* instead of the  /mean/,
  + the *median absolute deviation* instead of the /standard deviation/.  

** An example
24 determinations of the copper content in the wholemeal floor (in parts per million) sorted in ascending order (example 1.1 of Maronna, Martin & Yohai, /Robust Statistics. Theory and Methods./ 2006 J. Wiley):
#+BEGIN_EXPORT latex
\vspace{0.25cm}
#+END_EXPORT

#+BEGIN_EXPORT latex
\begin{tabular}{ r r r r r r r r } 
2.20 & 2.20 & 2.40 & 2.40 & 2.50 & 2.70 & 2.80 & 2.90\\
3.03 & 3.03 & 3.10 & 3.37 & 3.40 & 3.40 & 3.40 & 3.50\\
3.60 & 3.70 & 3.70 & 3.70 & 3.70 & 3.77 & 5.28 & \textcolor{orange}{28.95}
\end{tabular}
#+END_EXPORT

#+BEGIN_EXPORT latex
\vspace{0.2cm}
#+END_EXPORT

- The sample /mean/ is 4.28 while the /median/ is 3.38.

#+BEGIN_EXPORT latex
\vspace{0.2cm}
#+END_EXPORT
If we remove the *outlier*, 28.95, we get:
#+BEGIN_EXPORT latex
\vspace{0.2cm}
#+END_EXPORT
- A /mean/ of 3.21 and a /median/ of 3.37.

*** Making the graph 
:PROPERTIES:
:BEAMER_ENV: note
:END:
#+NAME: copper-table
|  2.20 | 0 |
|  2.20 | 1 |
|  2.40 | 0 |
|  2.40 | 1 |
|  2.50 | 0 |
|  2.70 | 0 |
|  2.80 | 0 |
|  2.90 | 0 |
|  3.03 | 0 |
|  3.03 | 1 |
|  3.10 | 0 |
|  3.37 | 0 |
|  3.40 | 0 |
|  3.40 | 1 |
|  3.40 | 2 |
|  3.50 | 0 |
|  3.60 | 0 |
|  3.70 | 0 |
|  3.70 | 1 |
|  3.70 | 2 |
|  3.70 | 3 |
|  3.77 | 0 |
|  5.28 | 0 |
| 28.95 | 0 |

#+NAME: copper-fig
#+HEADERS: :file imgs/copper_fig.png 
#+BEGIN_SRC gnuplot :exports both :var data=copper-table :cache yes
unset key
unset border
unset labels
set zeroaxis lt -1
set ytics (-1,1)
plot [2:7] [-0.05:0.2] data using 1:(0.05*$2) pt 6 ps 2 lc 'black'
#+END_SRC

#+RESULTS[47cd48839e6ae6d23451dbd40b79a6705342ec9a]: copper-fig
[[file:imgs/copper_fig.png]]
